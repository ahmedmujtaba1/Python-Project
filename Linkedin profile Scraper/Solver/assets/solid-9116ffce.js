const Y=(e,t)=>e===t,Z=Symbol("solid-track"),U={equals:Y};let G=W;const v=1,I=2,P={owned:null,cleanups:null,context:null,owner:null};var f=null;let j=null,o=null,a=null,y=null,O=0;function D(e,t){const s=o,n=f,r=e.length===0,l=r?P:{owned:null,cleanups:null,context:null,owner:t===void 0?n:t},i=r?e:()=>e(()=>A(()=>R(l)));f=l,o=null;try{return M(i,!0)}finally{o=s,f=n}}function _(e,t){t=t?Object.assign({},U,t):U;const s={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},n=r=>(typeof r=="function"&&(r=r(s.value)),V(s,r));return[Q.bind(s),n]}function oe(e,t,s){const n=K(e,t,!1,v);C(n)}function ee(e,t,s){G=le;const n=K(e,t,!1,v);(!s||!s.render)&&(n.user=!0),y?y.push(n):C(n)}function S(e,t,s){s=s?Object.assign({},U,s):U;const n=K(e,t,!0,0);return n.observers=null,n.observerSlots=null,n.comparator=s.equals||void 0,C(n),Q.bind(n)}function A(e){if(o===null)return e();const t=o;o=null;try{return e()}finally{o=t}}function ce(e){ee(()=>A(e))}function te(e){return f===null||(f.cleanups===null?f.cleanups=[e]:f.cleanups.push(e)),e}function ne(e){const t=S(e),s=S(()=>q(t()));return s.toArray=()=>{const n=s();return Array.isArray(n)?n:n!=null?[n]:[]},s}function Q(){if(this.sources&&this.state)if(this.state===v)C(this);else{const e=a;a=null,M(()=>F(this),!1),a=e}if(o){const e=this.observers?this.observers.length:0;o.sources?(o.sources.push(this),o.sourceSlots.push(e)):(o.sources=[this],o.sourceSlots=[e]),this.observers?(this.observers.push(o),this.observerSlots.push(o.sources.length-1)):(this.observers=[o],this.observerSlots=[o.sources.length-1])}return this.value}function V(e,t,s){let n=e.value;return(!e.comparator||!e.comparator(n,t))&&(e.value=t,e.observers&&e.observers.length&&M(()=>{for(let r=0;r<e.observers.length;r+=1){const l=e.observers[r],i=j&&j.running;i&&j.disposed.has(l),(i?!l.tState:!l.state)&&(l.pure?a.push(l):y.push(l),l.observers&&z(l)),i||(l.state=v)}if(a.length>1e6)throw a=[],new Error},!1)),t}function C(e){if(!e.fn)return;R(e);const t=f,s=o,n=O;o=f=e,se(e,e.value,n),o=s,f=t}function se(e,t,s){let n;try{n=e.fn(t)}catch(r){return e.pure&&(e.state=v,e.owned&&e.owned.forEach(R),e.owned=null),e.updatedAt=s+1,H(r)}(!e.updatedAt||e.updatedAt<=s)&&(e.updatedAt!=null&&"observers"in e?V(e,n):e.value=n,e.updatedAt=s)}function K(e,t,s,n=v,r){const l={fn:e,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:f,context:null,pure:s};return f===null||f!==P&&(f.owned?f.owned.push(l):f.owned=[l]),l}function T(e){if(e.state===0)return;if(e.state===I)return F(e);if(e.suspense&&A(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<O);)e.state&&t.push(e);for(let s=t.length-1;s>=0;s--)if(e=t[s],e.state===v)C(e);else if(e.state===I){const n=a;a=null,M(()=>F(e,t[0]),!1),a=n}}function M(e,t){if(a)return e();let s=!1;t||(a=[]),y?s=!0:y=[],O++;try{const n=e();return re(s),n}catch(n){s||(y=null),a=null,H(n)}}function re(e){if(a&&(W(a),a=null),e)return;const t=y;y=null,t.length&&M(()=>G(t),!1)}function W(e){for(let t=0;t<e.length;t++)T(e[t])}function le(e){let t,s=0;for(t=0;t<e.length;t++){const n=e[t];n.user?e[s++]=n:T(n)}for(t=0;t<s;t++)T(e[t])}function F(e,t){e.state=0;for(let s=0;s<e.sources.length;s+=1){const n=e.sources[s];if(n.sources){const r=n.state;r===v?n!==t&&(!n.updatedAt||n.updatedAt<O)&&T(n):r===I&&F(n,t)}}}function z(e){for(let t=0;t<e.observers.length;t+=1){const s=e.observers[t];s.state||(s.state=I,s.pure?a.push(s):y.push(s),s.observers&&z(s))}}function R(e){let t;if(e.sources)for(;e.sources.length;){const s=e.sources.pop(),n=e.sourceSlots.pop(),r=s.observers;if(r&&r.length){const l=r.pop(),i=s.observerSlots.pop();n<r.length&&(l.sourceSlots[i]=n,r[n]=l,s.observerSlots[n]=i)}}if(e.owned){for(t=e.owned.length-1;t>=0;t--)R(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0,e.context=null}function H(e){throw e}function q(e){if(typeof e=="function"&&!e.length)return q(e());if(Array.isArray(e)){const t=[];for(let s=0;s<e.length;s++){const n=q(e[s]);Array.isArray(n)?t.push.apply(t,n):t.push(n)}return t}return e}const ue=Symbol("fallback");function B(e){for(let t=0;t<e.length;t++)e[t]()}function ie(e,t,s={}){let n=[],r=[],l=[],i=0,c=t.length>1?[]:null;return te(()=>B(l)),()=>{let h=e()||[],w,u;return h[Z],A(()=>{let p=h.length,m,E,x,L,N,d,b,g,k;if(p===0)i!==0&&(B(l),l=[],n=[],r=[],i=0,c&&(c=[])),s.fallback&&(n=[ue],r[0]=D(X=>(l[0]=X,s.fallback())),i=1);else if(i===0){for(r=new Array(p),u=0;u<p;u++)n[u]=h[u],r[u]=D($);i=p}else{for(x=new Array(p),L=new Array(p),c&&(N=new Array(p)),d=0,b=Math.min(i,p);d<b&&n[d]===h[d];d++);for(b=i-1,g=p-1;b>=d&&g>=d&&n[b]===h[g];b--,g--)x[g]=r[b],L[g]=l[b],c&&(N[g]=c[b]);for(m=new Map,E=new Array(g+1),u=g;u>=d;u--)k=h[u],w=m.get(k),E[u]=w===void 0?-1:w,m.set(k,u);for(w=d;w<=b;w++)k=n[w],u=m.get(k),u!==void 0&&u!==-1?(x[u]=r[w],L[u]=l[w],c&&(N[u]=c[w]),u=E[u],m.set(k,u)):l[w]();for(u=d;u<p;u++)u in x?(r[u]=x[u],l[u]=L[u],c&&(c[u]=N[u],c[u](u))):r[u]=D($);r=r.slice(0,i=p),n=h.slice(0)}return r});function $(p){if(l[u]=p,c){const[m,E]=_(u);return c[u]=E,t(h[u],m)}return t(h[u])}}}function fe(e,t){return A(()=>e(t||{}))}const J=e=>`Stale read from <${e}>.`;function ae(e){const t="fallback"in e&&{fallback:()=>e.fallback};return S(ie(()=>e.each,e.children,t||void 0))}function he(e){const t=e.keyed,s=S(()=>e.when,void 0,{equals:(n,r)=>t?n===r:!n==!r});return S(()=>{const n=s();if(n){const r=e.children;return typeof r=="function"&&r.length>0?A(()=>r(t?n:()=>{if(!A(s))throw J("Show");return e.when})):r}return e.fallback},void 0,void 0)}function pe(e){let t=!1;const s=(l,i)=>l[0]===i[0]&&(t?l[1]===i[1]:!l[1]==!i[1])&&l[2]===i[2],n=ne(()=>e.children),r=S(()=>{let l=n();Array.isArray(l)||(l=[l]);for(let i=0;i<l.length;i++){const c=l[i].when;if(c)return t=!!l[i].keyed,[i,c,l[i]]}return[-1]},void 0,{equals:s});return S(()=>{const[l,i,c]=r();if(l<0)return e.fallback;const h=c.children;return typeof h=="function"&&h.length>0?A(()=>h(t?i:()=>{if(A(r)[0]!==l)throw J("Match");return c.when})):h},void 0,void 0)}function we(e){return e}export{ae as F,we as M,he as S,D as a,oe as b,_ as c,fe as d,S as e,pe as f,ce as o,A as u};
